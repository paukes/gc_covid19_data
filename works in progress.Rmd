---
title: "Work in Progress"
author: "PJKA"
date: "19/03/2020"
output: html_document
editor_options: 
  chunk_output_type: console
---


# Total Cases After 100th Case

```{r, warning=FALSE, message=FALSE, echo=FALSE}
#Identify Day of First Confirmed Case
canada_data %>%
  filter(province != 'total',
         case_type == 'conf',
         cases > 0 & cases < 2) %>%
  arrange(date) %>%
  print(n=Inf)
#AB: Mar. 8
#BC: Jan. 31
#MN: Mar. 14
#NB: Mar. 14
#NL: Mar. 19
#NS: Mar. 17
#ON: Jan. 31
#PEI: Mar. 15
#QC: Mar. 1
#SK: Mar. 15

first_case <- data.frame(province = factor(c('NL','PEI','NS','NB','QC','ON','MN','SK','AB','BC')),
                          first_date = ydm_hms(c(
                          '2020-19-03 05:00:00', #NL
                         '2020-15-03 05:00:00', #PEI
                         '2020-17-03 05:00:00', #NS
                         '2020-14-03 05:00:00', #NB
                         '2020-01-03 05:00:00', #QC
                         '2020-31-01 05:00:00', #ON
                         '2020-14-03 05:00:00', #MN
                         '2020-15-03 05:00:00', #SK
                         '2020-08-03 05:00:00', #AB
                         '2020-31-01 05:00:00' #BC
                         )))


#merge
case_100 <- merge(canada_data, first_case, by='province', all = TRUE)

case_100 <- case_100 %>%
  filter(case_type == 'conf') %>%
  mutate(day_since = as.numeric(difftime(date, first_date, units='days')))


ggplot(case_100 %>%
         filter(cases >0,
                province != 'total'),
       aes(day_since, cases, group=province))+
  geom_point(aes(colour=province, fill = after_scale(alpha(colour, 0.7))), pch=21, size=3)+
  geom_line(aes(colour=province), size=2, alpha=0.5)+
  scale_y_log10()+
  theme_classic()
```
